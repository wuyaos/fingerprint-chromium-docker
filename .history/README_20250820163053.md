# Dockerized fingerprint-chromium for DrissionPage

This repo provides an Alpine-based Docker image that bundles:
- fingerprint-chromium (adryfish/fingerprint-chromium) with stealth fingerprint features
- Xvfb + x11vnc + noVNC for real-time web UI viewing
- Chrome DevTools Protocol remote debugging on port 9222 for DrissionPage
- Chinese-ready: default timezone Asia/Shanghai, zh-CN locale, and CJK fonts

## Features

- Remote debugging: exposed on 9222
- VNC/noVNC: view live browser via web at 6080 or via VNC at 5900
- Alpine base with glibc shim for Chromium
- No secrets baked in; configure via environment variables
- Healthcheck on /json/version

## Quick start

Build locally:

```bash
docker build -t yourname/fingerprint-chromium-drission:latest .
```

Run:

```bash
docker run --rm -p 9222:9222 -p 6080:6080 -e VNC_PASSWORD=changeme \
  -e FINGERPRINT_SEED=2025 -e FINGERPRINT_PLATFORM=linux \
  -e FINGERPRINT_BRAND=Chrome -e BROWSER_LANG=zh-CN -e ACCEPT_LANG=zh-CN,zh \
  --name fpc yourname/fingerprint-chromium-drission:latest
```

Open the noVNC UI in your browser:
- http://localhost:6080
  - If prompted, use the password specified by VNC_PASSWORD

Verify remote debugging:
- http://localhost:9222/json/version should return JSON

## Use with DrissionPage

Example Python snippet to attach via CDP:

```python
from DrissionPage import Chromium

# Connect to the running container's CDP endpoint
c = Chromium(address='127.0.0.1', port=9222)
# Use as usual, e.g. open a tab
c.goto('https://www.example.com')
print(c.title)
```

You may mount a persistent user data dir to keep profiles:

```bash
docker run -d --name fpc \
  -p 9222:9222 -p 6080:6080 \
  -e VNC_PASSWORD=changeme \
  -v $(pwd)/data:/data \
  yourname/fingerprint-chromium-drission:latest
```

## Configuration

Environment variables:
- REMOTE_DEBUGGING_PORT (default 9222)
- SCREEN_WIDTH (default 1280)
- SCREEN_HEIGHT (default 800)
- SCREEN_DEPTH (default 24)
- VNC_PASSWORD (default changeme)
- FINGERPRINT_SEED (default 1000)
- FINGERPRINT_PLATFORM (linux|windows|macos, default linux)
- FINGERPRINT_BRAND (Chrome|Edge|Opera|Vivaldi or custom, default Chrome)
- FINGERPRINT_BRAND_VERSION (optional)
- BROWSER_LANG (default en-US)
- ACCEPT_LANG (default en-US,en)
- PROXY_SERVER (optional, e.g. http://host:port)
- CHROME_EXTRA_ARGS (optional extra flags)

The container runs Chromium with flags:
- --remote-debugging-port=${REMOTE_DEBUGGING_PORT}
- --user-data-dir=/data
- --lang, --accept-lang
- --fingerprint*, and Docker-friendly flags like --no-sandbox

Ports:
- 9222: Chrome DevTools
- 5900: VNC (x11vnc)
- 6080: noVNC (web)

## Security
- No credentials are hardcoded
- Prefer running behind a firewall/reverse proxy when exposing ports on public hosts
- Change VNC_PASSWORD
- Consider limiting access to 9222 using firewall rules

## CI/CD (GitHub Actions)

This repo includes .github/workflows/docker-build.yml that:

- Builds on manual trigger (workflow_dispatch) with configurable fingerprint-chromium version
- Pushes to GHCR and optionally Docker Hub (if DOCKERHUB_* secrets are set)
- Targets linux/amd64
- Provides tags: latest on default branch, git tag, and sha

Required repository secrets for Docker Hub (optional):

- DOCKERHUB_REPO (e.g. docker.io/yourname/fingerprint-chromium-drission)
- DOCKERHUB_USERNAME
- DOCKERHUB_TOKEN

## Healthcheck

Container health is based on <http://127.0.0.1:9222/json/version>.

## Notes

- The fingerprint-chromium Linux artifact is downloaded at build time; update FC_VERSION in Dockerfile to match desired release.
- Alpine uses musl, so we install glibc via sgerrand packages to satisfy Chromium runtime requirements.

